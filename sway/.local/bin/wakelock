#!/usr/bin/env bash
#
# Switch the always on (wakelock) mode on and off.
set -e

SCRIPT_DIR="$HOME/.config/sway/scripts"
SWAY_STATE="${XDG_RUNTIME_DIR:-/tmp/$USER}/sway"
SWAY_SCRIPT_IDLE="$SCRIPT_DIR/idle.sh"
PID_FILE="$SWAY_STATE/swayidle.pid"

[[ ! -f "$PID_FILE" ]] && exit 1

process_pid="$(cat $PID_FILE)"
if ps -p $process_pid > /dev/null; then
    kill "$process_pid"
else
    exec "$SWAY_SCRIPT_IDLE"
fi
